webpackJsonp([6],{"28lG":function(t,e){},bdK3:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("WhC7"),n={data:function(){return{proStr:"",activeName:"first",uploadWindow:!1,upLoadData:{id:""},action:a.a.url.dataCheck.uploadFile,pageSize:10,total:100,currentPage:1,look:!1,fileList:[],checkTableData:[],gridData:[]}},created:function(){this.$parent.setSelectDisable(!0),this.$parent.setProjectInfo(),this.$nextTick(function(){this.getWorkerInfo()})},methods:{getWorkerInfo:function(){var t=this,e=this.pageSize,o=(this.currentPage-1)*e;this.proStr=this.$parent.getProjectId(),console.log("projectId:"+this.proStr),a.a.post(a.a.url.dataCheck.initData,{first:o,count:e,proStr:this.proStr}).then(function(e){console.log(e),t.checkTableData=e.rows,t.total=e.total})},handleSizeChange:function(t){console.log("每页 "+t+" 条"),this.pageSize=t,this.getWorkerInfo()},handleCurrentChange:function(t){console.log("当前页: "+t),this.currentPage=t,this.getWorkerInfo()},getDetail:function(t){var e=this;this.look=!0,this.workId=t,a.a.post(a.a.url.dataCheck.detail,{id:t}).then(function(t){console.log(t),e.gridData=t.data})},downloadExcel:function(){window.open(a.a.url.dataCheck.exportExcel+"?proStr="+this.proStr+"&dataType="+this.dataType)},doUpload:function(t){this.upLoadData.id=t,this.uploadWindow=!0},beforeUpload:function(t){var e=new FileReader;e.readAsDataURL(t),e.onload=function(){}},handlePreview:function(t){console.log(t)},handleRemove:function(t,e){console.log(t,e)},uploadSeccess:function(t){console.log(t),"success"==t.status?(this.fileList=[],this.uploadWindow=!1,this.getWorkerInfo()):this.$message.warning(t.msg)},beforeRemove:function(t,e){return this.$confirm("确定移除 "+t.name+"？")},handleExceed:function(t,e){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+t.length+" 个文件，共选择了 "+(t.length+e.length)+" 个文件")},exportSql:function(t){window.open(a.a.url.dataCheck.exportSql+"?id="+t)},doConfirm:function(){var t=this,e="",o="";this.$confirm("确认完成, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.a.post(a.a.url.dataCheck.confirm,{proStr:t.proStr}).then(function(a){console.log(a),e=a.type,o=a.msg,t.$message({type:e,message:o})})}).catch(function(){t.$message({type:"info",message:"取消确认！"})})}}},i={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"base-data-check"},[o("div",{staticClass:"w-table"},[o("div",{staticClass:"w-table-btn"},[o("span",{staticClass:"active",on:{click:t.doConfirm}},[o("i",{staticClass:"iconfont icon-conf-complete"}),t._v("确认完成")])]),t._v(" "),o("div",{staticClass:"w-table-content"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.checkTableData}},[o("el-table-column",{attrs:{prop:"map.type",label:"分类",align:"center"}}),t._v(" "),o("el-table-column",{attrs:{prop:"map.subSystem",label:"子系统"}}),t._v(" "),o("el-table-column",{attrs:{prop:"checkResult",label:"校验结果"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",{class:e.row.map.state?"dangerous":"noraml"},[t._v(t._s(e.row.checkResult))])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",{staticClass:"operate"},[o("i",{staticClass:"iconfont icon-look-over",on:{click:function(o){t.getDetail(e.row.id)}}}),t._v(" "),o("i",{staticClass:"iconfont icon-conf-complete",on:{click:function(o){t.doUpload(e.row.id)}}}),t._v(" "),o("i",{staticClass:"iconfont icon-export",on:{click:function(o){t.exportSql(e.row.id)}}})])]}}])})],1)],1)]),t._v(" "),o("el-dialog",{attrs:{title:"新增",width:"60%",visible:t.look},on:{"update:visible":function(e){t.look=e}}},[o("el-table",{attrs:{data:t.gridData,height:"250"}},[o("el-table-column",{attrs:{property:"question","show-overflow-tooltip":"true",label:"问题描述"}}),t._v(" "),o("el-table-column",{attrs:{property:"everyTime","show-overflow-tooltip":"true",label:"每次用量"}})],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"文件上传",width:"30%",visible:t.uploadWindow},on:{"update:visible":function(e){t.uploadWindow=e}}},[o("el-upload",{staticClass:"upload-demo",attrs:{action:t.action,"on-preview":t.handlePreview,"on-remove":t.handleRemove,"on-success":t.uploadSeccess,"before-remove":t.beforeRemove,"before-upload":t.beforeUpload,data:t.upLoadData,multiple:"",limit:1,"on-exceed":t.handleExceed,"file-list":t.fileList}},[o("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传xls/xlsx文件，且不超过500kb")])],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.uploadWindow=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var l=o("VU/8")(n,i,!1,function(t){o("c0lA"),o("28lG")},"data-v-21b32cdc",null);e.default=l.exports},c0lA:function(t,e){}});
//# sourceMappingURL=6.b4fb1481faf57d20beb8.js.map