webpackJsonp([13],{kRiN:function(t,e){},zYzR:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("WhC7"),i={data:function(){return{pmId:"",dataType:"3",formLabelWidth:"120px",pageSize:10,total:100,currentPage:1,isActive:!1,process:{},look:!1,uploadWindow:!1,workderInforWindow:!1,action:a.a.url.basicData.uploadFile,fileList:[],workerInfo:[],workId:0,lookTile:"",cols:[],gridData:[],workForm:{tableCode:"",tableName:"",tableCnName:"",dataType:"",tableAttention:""},rules:{tableCode:[{max:32,message:"长度最多为32",trigger:"blur"}],tableName:[{required:!0,message:"请输入库表名称",trigger:"blur"}],tableCnName:[{required:!0,message:"请输入中文名称",trigger:"blur"}],dataType:[{required:!0,message:"请输入数据类型",trigger:"blur"},{pattern:/^[0-9]*$/,message:"请输入数字",trigger:"blur"}],tableAttention:[]}}},created:function(){this.$parent.setSelectDisable(!0),this.$parent.setProjectInfo(),this.$nextTick(function(){this.getWorkerInfo()})},methods:{tabSwitch:function(t,e){console.log(t,e),this.activeName=t.name,this.getWorkerInfo()},deleteRow:function(){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message({type:"success",message:"删除成功!"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},getWorkerInfo:function(){var t=this,e=this.pageSize,o=(this.currentPage-1)*e;this.pmId=this.$parent.getProjectId(),console.log("projectId:"+this.pmId),a.a.post(a.a.url.basicData.initData,{first:o,count:e,pmId:this.pmId,dataType:this.dataType}).then(function(e){console.log(e),t.workerInfo=e.rows,t.total=e.total,t.process=e.process,null==t.process.isEasyDataUse||1!=t.process.isEasyDataUse?t.isActive=!1:1==t.process.isEasyDataUse&&(t.isActive=!0)})},handleSizeChange:function(t){console.log("每页 "+t+" 条"),this.pageSize=t,this.getWorkerInfo()},handleCurrentChange:function(t){console.log("当前页: "+t),this.currentPage=t,this.getWorkerInfo()},getDetail:function(t){var e=this;this.look=!0,this.workId=t.id,this.lookTile=t.tableName,a.a.post(a.a.url.basicData.detail,{id:t.id}).then(function(t){console.log(t),e.gridData=t.data,e.cols=t.cols})},downloadExcel:function(){window.open(a.a.url.basicData.exportExcel+"?pmId="+this.pmId+"&dataType="+this.dataType)},handlePreview:function(t){console.log(t)},handleRemove:function(t,e){console.log(t,e)},uploadSeccess:function(t){console.log(t),"success"==t.status?(this.fileList=[],this.uploadWindow=!1,this.getWorkerInfo()):this.$message.warning(t.msg)},beforeRemove:function(t,e){return this.$confirm("确定移除 "+t.name+"？")},handleExceed:function(t,e){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+t.length+" 个文件，共选择了 "+(t.length+e.length)+" 个文件")},exportDataInfo:function(){console.log(this.workId),window.open(a.a.url.basicData.exportDataInfo+"?id="+this.workId)},exportSql:function(t){window.open(a.a.url.basicData.exportSql+"?id="+t)},openWorkinfoWindow:function(){this.workId=0,this.tableCode="",this.tableName="",this.tableCnName="",this.dataType="",this.tableAttention="",this.workderInforWindow=!0},addOrModify:function(t){var e=this;console.log(t);var o={id:this.workId,tableCode:this.workForm.tableCode,tableName:this.workForm.tableName,tableCnName:this.workForm.tableCnName,dataType:this.workForm.dataType,tableAttention:this.workForm.tableAttention};this.$refs[t].validate(function(t){t&&a.a.post(a.a.url.basicData.addOrModify,o).then(function(t){(t.status="success")&&e.getWorkerInfo(),e.workderInforWindow=!1})})},doConfirm:function(){var t=this,e="",o="";this.$confirm("确认完成, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.a.post(a.a.url.basicData.confirm,{pmId:t.pmId,dataType:t.dataType}).then(function(a){console.log(a),e=a.type,o=a.msg,t.$message({type:e,message:o}),"success"==e&&(t.isActive=!0)})}).catch(function(){t.$message({type:"info",message:"取消确认！"})})}}},l={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"base-data-maintain"},[o("div",{staticClass:"tab"},[o("div",{staticClass:"w-table"},[o("div",{staticClass:"w-table-btn"},[o("span",{class:{active:t.isActive},on:{click:t.doConfirm}},[o("i",{staticClass:"iconfont icon-conf-complete"}),t._v("确认完成")])]),t._v(" "),o("div",{staticClass:"w-table-content"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.workerInfo}},[o("el-table-column",{attrs:{prop:"tableName",label:"THIS表名"}}),t._v(" "),o("el-table-column",{attrs:{prop:"tableCnName",label:"数据涵义"}}),t._v(" "),o("el-table-column",{attrs:{prop:"standardCode",label:"标准文号"}}),t._v(" "),o("el-table-column",{attrs:{prop:"tableAttention",label:"注意事项"}}),t._v(" "),o("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",{staticClass:"operate"},[o("i",{staticClass:"iconfont icon-look-over",on:{click:function(o){t.getDetail(e.row)}}}),t._v(" "),o("i",{staticClass:"iconfont icon-export",on:{click:function(o){t.exportSql(e.row.id)}}})])]}}])})],1)],1),t._v(" "),o("div",{staticClass:"w-table-page"},[o("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,20,30,40],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])]),t._v(" "),o("el-dialog",{attrs:{title:t.lookTile,width:"50%",visible:t.look},on:{"update:visible":function(e){t.look=e}}},[o("el-table",{staticClass:"my-table-style",attrs:{data:t.gridData}},t._l(t.cols,function(t,e){return o("el-table-column",{key:e,attrs:{property:t,label:t}})})),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"medium"},on:{click:function(e){t.look=!1}}},[t._v("取消")]),t._v(" "),o("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){t.exportDataInfo()}}},[t._v("\n        导出\n      ")])],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"基础数据",width:"30%",visible:t.workderInforWindow},on:{"update:visible":function(e){t.workderInforWindow=e}}},[o("el-form",{ref:"workForm",attrs:{model:t.workForm,rules:t.rules}},[o("el-form-item",{attrs:{label:"库表编号","label-width":"80px",prop:"tableCode"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:t.workForm.tableCode,callback:function(e){t.$set(t.workForm,"tableCode",e)},expression:"workForm.tableCode"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"库表名称","label-width":"80px",prop:"tableName",required:""}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:t.workForm.tableName,callback:function(e){t.$set(t.workForm,"tableName",e)},expression:"workForm.tableName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"中文名称","label-width":"80px",prop:"tableCnName",required:""}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:t.workForm.tableCnName,callback:function(e){t.$set(t.workForm,"tableCnName",e)},expression:"workForm.tableCnName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"数据类型","label-width":"80px",prop:"dataType",required:""}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:t.workForm.dataType,callback:function(e){t.$set(t.workForm,"dataType",e)},expression:"workForm.dataType"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"注意事项","label-width":"80px",prop:"tableAttention"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:t.workForm.tableAttention,callback:function(e){t.$set(t.workForm,"tableAttention",e)},expression:"workForm.tableAttention"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.workderInforWindow=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addOrModify("workForm")}}},[t._v("确 定")])],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"文件上传",width:"30%",visible:t.uploadWindow},on:{"update:visible":function(e){t.uploadWindow=e}}},[o("el-upload",{staticClass:"upload-demo",attrs:{action:t.action,"on-preview":t.handlePreview,"on-remove":t.handleRemove,"on-success":t.uploadSeccess,"before-remove":t.beforeRemove,multiple:"",limit:1,"on-exceed":t.handleExceed,"file-list":t.fileList}},[o("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传xls/xlsx文件，且不超过500kb")])],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.uploadWindow=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var n=o("Z0/y")(i,l,!1,function(t){o("kRiN")},"data-v-7a8b0790",null);e.default=n.exports}});
//# sourceMappingURL=13.46f8a07925d578567723.js.map