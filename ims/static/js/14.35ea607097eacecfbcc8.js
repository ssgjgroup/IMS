webpackJsonp([14],{LW6I:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=t("WhC7"),r={data:function(){return{formOpen:!0,title:"新增",uploadWindow:!1,workId:0,isActive:!1,process:{},interfaceInfoData:[],addAndModifyWindow:!1,upLoadData:{pmId:"",operator:""},completeSelect:[{value:"0",label:"未完成"},{value:"1",label:"完成"}],plId:"",plList:[],reason:"",ranges:[{label:"否",options:[{value:"不在合同范围",label:"不在合同范围"},{value:"本期不实施",label:"本期不实施"},{value:"医院暂时不用",label:"医院暂时不用"},{value:"其他",label:"其他"}]},{label:"是",options:[{value:"",label:"是"}]}],fileList:[],workForm:{map:[{plName:""}],plId:"",hwName:"",brand:"",model:"",content:"",num:1,useContent:"",isScope:"1",noScopeCode:""},rules:{plId:{required:!0,message:"请选择系统名称",trigger:"change"},hwName:{required:!0,message:"请输入硬件名称",trigger:"blur"},brand:{required:!0,message:"请输入最低参数",trigger:"blur"},model:{required:!0,message:"请输入推荐型号",trigger:"blur"},useContent:{required:!0,message:"请输入用途",trigger:"blur"}},action:n.a.url.softHardware.uploadFile,workerInfo:[],uploadForm:{uploadFile:""},pageSize:10,total:100,currentPage:1,dialogFormVisible:!1,formLabelWidth:"120px"}},created:function(){this.$parent.setSelectDisable(!0),this.$parent.setProjectInfo(),this.initSourceData(),this.$nextTick(function(){this.getWorkerInfo()})},methods:{initSourceData:function(){n.a.post(n.a.url.softHardware.initSourceData,{pmId:this.$parent.getProjectId(),operator:this.$parent.getUserId()}).then(function(e){console.log(e.msg)})},getWorkerInfo:function(){var e=this,o=this.$parent.getProjectId(),t=this.pageSize,r=(this.currentPage-1)*t;n.a.post(n.a.url.softHardware.initData,{first:r,count:t,pmId:o}).then(function(o){"success"==o.status&&(console.info(o),console.info(e.$parent.getProjectId()),e.workerInfo=o.rows,e.total=o.total,e.plList=o.plList,e.process=o.process,null==e.process.isHardwareList||1!=e.process.isHardwareList?e.isActive=!1:1==e.process.isHardwareList&&(e.isActive=!0))})},handleSizeChange:function(e){console.log("每页 "+e+" 条"),this.pageSize=e,this.getWorkerInfo()},handleCurrentChange:function(e){console.log("当前页: "+e),this.currentPage=e,this.getWorkerInfo()},numChange:function(e){var o=this;this.$nextTick(function(){var t=e.num;console.info(t),n.a.post(n.a.url.softHardware.numChange,{id:e.id,num:t,operator:o.$parent.getUserId()}).then(function(e){console.info(e.msg)})})},doSelect:function(e){this.workForm.plId=e,this.plId=e},doRangeSelect:function(e,o){console.info("noScopeCode:"+e),console.info("id:"+o),n.a.post(n.a.url.softHardware.changeScope,{noScopeCode:e,id:o,operator:this.$parent.getUserId()}).then(function(e){console.log(e.msg)})},completeChange:function(e){console.info(e.content),n.a.post(n.a.url.softHardware.changeContent,{content:e.content,id:e.id,operator:this.$parent.getUserId()}).then(function(e){console.log(e.msg)})},showCol:function(e){return console.info(e.creator),0!=e.creator},rowStyle:function(e,o){return 1===e.row.isScope?"default-row-class":"invalid-row-class"},openAddAndModifyWindow:function(e){void 0!==this.$refs.workForm&&this.$refs.workForm.resetFields(),console.info(e),0==e?(this.workForm.map.plName="",this.workForm.hwName="",this.workForm.brand="",this.workForm.model="",this.workForm.num=1,this.workForm.useContent="",this.workForm.isScope="1",this.workForm.noScopeCode="",this.plId="",this.reason="",this.workId=0):(this.workForm.map.plName=e.map.plName,this.workForm.hwName=e.hwName,this.workForm.brand=e.brand,this.workForm.model=e.model,this.workForm.num=e.num,this.workForm.useContent=e.useContent,this.workForm.isScope=e.isScope.toString(),this.workForm.noScopeCode=e.noScopeCode.toString(),this.reason=e.noScopeCode.toString(),this.workForm.plId=e.plId,this.plId=e.plId,this.workId=e.id),this.addAndModifyWindow=!0},doDelete:function(e){var o=this;this.$confirm("删除本条数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.a.post(n.a.url.softHardware.delete,{id:e}).then(function(e){"success"==e.status&&(o.$message({type:"success",message:"删除成功!"}),o.getWorkerInfo())})}).catch(function(){o.$message({type:"info",message:"已取消删除"})})},addOrModify:function(e){var o=this;this.addAndModifyWindow=!0;var t={id:this.workId,pmId:this.$parent.getProjectId(),plId:this.plId,hwName:this.workForm.hwName,brand:this.workForm.brand,model:this.workForm.model,num:this.workForm.num,useContent:this.workForm.useContent,noScopeCode:this.reason,operator:this.$parent.getUserId()};this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;n.a.post(n.a.url.softHardware.addOrModify,t).then(function(e){(e.status="success")&&o.getWorkerInfo()}),o.addAndModifyWindow=!1})},downloadExcel:function(){var e=this.$parent.getProjectId();window.open(n.a.url.softHardware.exportExcel+"?pmId="+e)},sizeChange:function(e){console.log("每页 "+e+" 条"),this.pageSize=e,this.getWorkerInfo()},currentChange:function(e){console.log("当前页: "+e),this.currentPage=e,this.getWorkerInfo()},doUpload:function(){this.upLoadData.pmId=this.$parent.getProjectId(),this.upLoadData.operator=this.$parent.getUserId(),this.uploadWindow=!0},beforeUpload:function(e){var o=new FileReader;o.readAsDataURL(e),o.onload=function(){}},handlePreview:function(e){console.log(e)},handleRemove:function(e,o){console.log(e,o)},uploadSeccess:function(e){console.log(e),"success"==e.status?(this.fileList=[],this.uploadWindow=!1,this.getWorkerInfo()):this.$message.warning(e.msg)},beforeRemove:function(e,o){return this.$confirm("确定移除 "+e.name+"？")},handleExceed:function(e,o){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+o.length)+" 个文件")},doConfirm:function(){var e=this,o=this.$parent.getProjectId(),t="",r="",a="",i=0;this.isActive?(t="此操作将取消确认硬件清单, 是否继续?",r="取消成功",a="已撤销取消",i=0):(t="此操作将确认硬件清单, 是否继续?",r="确认成功",a="已取消确认",i=1),this.$confirm(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.a.post(n.a.url.softHardware.confirm,{pmId:o,operator:e.$parent.getUserId(),isHardwareList:i}).then(function(o){"success"==o.status&&(e.$message({type:"success",message:r}),e.isActive?e.isActive=!1:e.isActive=!0)})}).catch(function(){e.$message({type:"info",message:a})})}}},a={render:function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"hardwar-prepare"},[t("div",{staticClass:"w-table"},[t("div",{staticClass:"w-table-btn"},[t("span",{class:{active:e.isActive},on:{click:e.doConfirm}},[t("i",{staticClass:"iconfont icon-conf-complete"}),e._v("确认完成")]),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:!e.isActive,expression:"!isActive"}],on:{click:function(o){e.openAddAndModifyWindow(0)}}},[t("i",{staticClass:"iconfont icon-new-add"}),e._v("新增")]),e._v(" "),t("span",{on:{click:e.downloadExcel}},[t("i",{staticClass:"iconfont icon-export"}),e._v("导出")])]),e._v(" "),t("div",{staticClass:"w-table-content"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.workerInfo}},[t("el-table-column",{attrs:{prop:"map.plName",label:"系统名称",width:"100px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"hwName",label:"硬件名称",width:"150px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"brand",label:"最低参数",width:"200px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"model",label:"推荐型号"}}),e._v(" "),t("el-table-column",{attrs:{prop:"num",align:"center",width:"150px",label:"数量"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-input-number",{attrs:{size:"mini",min:1,step:1,disabled:e.isActive},on:{change:function(t){e.numChange(o.row)}},model:{value:o.row.num,callback:function(t){e.$set(o.row,"num",t)},expression:"scope.row.num"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"useContent",label:"用途"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"本期情况"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-select",{attrs:{size:"mini",disabled:e.isActive,placeholder:"请选择"},on:{change:function(t){e.doRangeSelect(o.row.noScopeCode,o.row.id)}},model:{value:o.row.noScopeCode,callback:function(t){e.$set(o.row,"noScopeCode",t)},expression:"scope.row.noScopeCode"}},e._l(e.ranges,function(o){return t("el-option-group",{key:o.label,attrs:{label:o.label}},e._l(o.options,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))}))]}}])}),e._v(" "),t("el-table-column",{attrs:{align:"center",disabled:e.isActive,label:"完成情况"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-select",{attrs:{disabled:e.isActive,size:"mini",placeholder:"请选择"},on:{change:function(t){e.completeChange(o.row)}},model:{value:o.row.content,callback:function(t){e.$set(o.row,"content",t)},expression:"scope.row.content"}},e._l(e.completeSelect,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))]}}])}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showCol(o.row),expression:"showCol(scope.row)"}],staticClass:"operate"},[t("i",{staticClass:"iconfont icon-edit",on:{click:function(t){e.openAddAndModifyWindow(o.row)}}}),e._v(" "),t("i",{directives:[{name:"show",rawName:"v-show",value:!e.isActive,expression:"!isActive"}],staticClass:"iconfont icon-delete",on:{click:function(t){e.doDelete(o.row.id)}}})])]}}])})],1)],1),e._v(" "),t("div",{staticClass:"w-table-page"},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),e._v(" "),t("el-dialog",{attrs:{title:"新增",width:"30%",visible:e.addAndModifyWindow},on:{"update:visible":function(o){e.addAndModifyWindow=o}}},[t("el-form",{ref:"workForm",attrs:{model:e.workForm,rules:e.rules,disabled:e.isActive}},[t("el-form-item",{attrs:{label:"系统名称","label-width":"80px",prop:"plId"}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:function(o){e.doSelect(e.plId)}},model:{value:e.plId,callback:function(o){e.plId=o},expression:"plId"}},e._l(e.plList,function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"硬件名称",prop:"hwName","label-width":"80px"}},[t("el-input",{model:{value:e.workForm.hwName,callback:function(o){e.$set(e.workForm,"hwName",o)},expression:"workForm.hwName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"最低参数",prop:"brand","label-width":"80px"}},[t("el-input",{model:{value:e.workForm.brand,callback:function(o){e.$set(e.workForm,"brand",o)},expression:"workForm.brand"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"推荐型号",prop:"model","label-width":"80px"}},[t("el-input",{model:{value:e.workForm.model,callback:function(o){e.$set(e.workForm,"model",o)},expression:"workForm.model"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"数量",prop:"num","label-width":"80px"}},[t("el-input-number",{attrs:{min:1,step:1},model:{value:e.workForm.num,callback:function(o){e.$set(e.workForm,"num",o)},expression:"workForm.num"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"用途",prop:"useContent","label-width":"80px"}},[t("el-input",{model:{value:e.workForm.useContent,callback:function(o){e.$set(e.workForm,"useContent",o)},expression:"workForm.useContent"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"本期范围","label-width":"80px"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.reason,callback:function(o){e.reason=o},expression:"reason"}},e._l(e.ranges,function(o){return t("el-option-group",{key:o.label,attrs:{label:o.label}},e._l(o.options,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))}))],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isActive,expression:"!isActive"}],staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(o){e.addAndModifyWindow=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(o){e.addOrModify("workForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var i=t("Z0/y")(r,a,!1,function(e){t("iB4K")},"data-v-73a6b513",null);o.default=i.exports},iB4K:function(e,o){}});
//# sourceMappingURL=14.35ea607097eacecfbcc8.js.map