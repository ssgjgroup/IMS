webpackJsonp([8],{"+1CO":function(e,t){},XWqO:function(e,t){},oSd9:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("3cXf"),i=a.n(l),s=a("WhC7"),o=a("7VF+"),n=a.n(o),r={data:function(){return{installTableData:[{deptName:"挂号处",needSoftware:"选项2",needHardware:{printer:["激光"],desktop:["台式机"],moreScreen:[],ticker:[],cardReader:[]},map:{puserName:"",siteInfo:""},currentScope:"",assignedTo:"",siteNumber:6,stateTxt:"已安装",stateClass:"installed"}],isActive:!1,dataType:0,deptName:"",ranges:[{label:"否",options:[{value:"不在合同范围",label:"不在合同范围"},{value:"本期不实施",label:"本期不实施"},{value:"医院暂时不用",label:"医院暂时不用"},{value:"其他",label:"其他"}]},{label:"是",options:[{value:"",label:"是"}]}],selectData:{needSoftware:[],currentScope:[{value:"选项1",label:"是"},{value:"选项2",label:"否-本期不实施"}],assignedTo:[{value:"选项1",label:"三毛"},{value:"选项2",label:"五毛"}],siteNumber:[{value:"1",label:"1"},{value:"2",label:"2"},{value:"3",label:"3"},{value:"4",label:"4"},{value:"5",label:"5"},{value:"6",label:"6"},{value:"7",label:"7"},{value:"8",label:"8"},{value:"9",label:"9"},{value:"10",label:"10"}]},chart:!1,newAdd:!1,newPage:!1,formData:{},action:s.a.url.hospitalInfo.uploadFile+"?ssgs="+this.$parent.getContractId(),fileList:[],uploadWindow:!1,selectDeptType:[],selectDept:[],selectFormData:[{deptName:"挂号处",needSoftware:"选项2",needHardware:{printer:["激光"],desktop:["台式机"],moreScreen:[],ticker:[],cardReader:[]},currentScope:"",assignedTo:"",siteNumber:6,stateTxt:"已安装",stateClass:"installed"}],fileId:0,fileName:"",siteDetailData:[],pageSize:10,total:100,currentPage:1,imgPaths:[{name:"bootstrap.docx",url:"http://47.97.170.21:8081/shareFolder/simulate/simulate_1523410080077/Bootstrap.docx"}],pageForm:{siteName:"",ipAddress:"",building:"",floor:"",pc:"",install:"1"},pageFormList:[{siteName:"",ipAddress:"",building:"",floor:"",pc:"",install:""}],dialogImageUrl:"",dialogVisible:!1,rowId:0,array:[],arrayNum:[]}},created:function(){this.$parent.setSelectDisable(!0),this.$parent.setProjectInfo(),this.$nextTick(function(){this.getStartData()})},methods:{imgPathsUrl:function(e,t){if(""!=e){var a=e.split(";"),l=new Array;if(a.length>0){for(var i=0;i<a.length;i++){var o={id:t,name:a[i],url:s.a.url.siteCenter.imagePath+a[i]};l.push(o)}this.image=!0}return l}},getStartData:function(){var e=this;this.userId=this.$parent.getUserId(),this.proStr=this.$parent.getProjectId(),console.log(this.proStr);var t=this.pageSize,a=(this.currentPage-1)*t;s.a.post(s.a.url.workSiteInstall.initData,{first:a,count:t,userId:this.userId,pmId:this.proStr}).then(function(t){console.log(t.rows),e.installTableData=t.rows,e.selectData.needSoftware=t.productLineList,e.selectData.needHardware=t.hardList,e.selectData.assignedTo=t.userList,e.total=t.total})},siteEnd:function(){var e=this;this.$confirm("确认完成, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.a.post(s.a.url.workSiteInstall.siteEnd,{pmId:e.$parent.getProjectId(),userId:e.$parent.getUserId(),dataType:e.dataType}).then(function(t){e.dataType=t.dataType,"1"==t.type?e.isActive=!0:e.isActive=!1,e.$message({message:t.msg,type:"success"})})}).catch(function(){e.$message({type:"info",message:"取消确认！"})})},addSiteInstallDetail:function(e){var t=this;s.a.post(s.a.url.workSiteInstall.addSiteInstallDetail,{id:e,pmId:this.$parent.getProjectId(),operator:this.$parent.getUserId()}).then(function(a){console.log("site=",a.siteInstallDetails),t.siteDetailData=a.siteInstallDetails,t.deptName=a.deptName,t.rowId=e}),this.newPage=!0},removeSite:function(e){var t=this;s.a.post(s.a.url.workSiteInstall.removeSite,{id:e,pmId:this.$parent.getProjectId()}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.getStartData()})},openAddWindows:function(){var e=this;this.newAdd=!0,s.a.post(s.a.url.workSiteInstall.formData,{pmId:this.$parent.getProjectId(),serialNo:this.$parent.getCustomerId()}).then(function(t){console.log(t),e.selectDeptType=t.deptTypeList,e.selectFormData=t.productLineList})},deptType:function(e){var t=this;this.selectDept="";var a={deptType:e,serialNo:this.$parent.getCustomerId()};s.a.post(s.a.url.workSiteInstall.selectDeptList,a).then(function(e){t.selectDept=e.deptList})},saveDeptData:function(){var e=this,t={deptType:this.formData.deptType,deptCode:this.formData.departName,cpzxt:this.formData.userSystem,operator:this.$parent.getUserId(),pmId:this.$parent.getProjectId(),cId:this.$parent.getContractId(),serialNo:this.$parent.getCustomerId()};s.a.post(s.a.url.workSiteInstall.updateSiteInstall,t).then(function(t){1==t.status?e.$message.error("科室名称重复！"):(e.$message({message:"成功保存",type:"success"}),e.getStartData(),e.newAdd=!1)})},submitForm:function(e){},saveSiteDetail:function(){var e=this;console.log("sitenam="+i()(this.siteDetailData[1].siteName)),s.a.post(s.a.url.workSiteInstall.saveSiteDetail,{detailData:i()(this.siteDetailData),operator:this.$parent.getUserId()}).then(function(t){e.$message({message:"成功保存",type:"success"}),e.newAdd=!1})},addSiteDetail:function(){var e=this;s.a.post(s.a.url.workSiteInstall.addItem,{pId:this.rowId}).then(function(t){e.$message({message:"新增成功",type:"success"}),e.addSiteInstallDetail(e.rowId)})},deteleSite:function(e){var t=this;s.a.post(s.a.url.workSiteInstall.deleteItem,{id:e}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.addSiteInstallDetail(t.rowId)})},doRangeSelect:function(e,t){console.info("noScopeCode:"+e),console.info("id:"+t),s.a.post(s.a.url.workSiteInstall.changeScope,{noScopeCode:e,id:t}).then(function(e){console.log(e.msg)})},doHardWareSelect:function(e,t){console.info("hard:"+e),console.info("id:"+t),s.a.post(s.a.url.workSiteInstall.changeHardWare,{hwId:e,id:t,pmId:this.$parent.getProjectId(),operator:this.$parent.getUserId()}).then(function(e){console.log(e.msg)})},doSoftSelect:function(e,t){console.info("hard:"+e),console.info("id:"+t),s.a.post(s.a.url.workSiteInstall.changeSoftWare,{pdId:e,id:t,pmId:this.$parent.getProjectId(),operator:this.$parent.getUserId()}).then(function(e){console.log(e.msg)})},doUserSelect:function(e,t){console.info("hard:"+e),console.info("id:"+t),s.a.post(s.a.url.workSiteInstall.changeUser,{puserId:e,id:t,operator:this.$parent.getUserId()}).then(function(e){console.log(e.msg)})},doSiteSelect:function(e,t){console.info("hard:"+e),console.info("id:"+t),s.a.post(s.a.url.workSiteInstall.changeSite,{num:e,id:t,operator:this.$parent.getUserId()}).then(function(e){console.log(e.msg)})},UploadUrl:function(e){return s.a.url.workSiteInstall.uploadFileSite+"?operator="+this.$parent.getUserId()+"&id="+e},handleRemoves:function(e,t){var a=0,l="";e.id?(a=e.id,l=e.name):(a=e.response.id,l=e.response.path);var i={name:l,id:a};console.log(i),s.a.post(s.a.url.workSiteInstall.deleteImg,i).then(function(e){console.log(e)})},openUploadWindow:function(){this.fileList=[],this.uploadWindow=!0,this.action=s.a.url.workSiteInstall.uploadFile+"?serialNo="+this.$parent.getCustomerId()+"&cId="+this.$parent.getContractId()+"&pmId="+this.$parent.getProjectId()+"&creator="+this.$parent.getUserId()},downloadExcel:function(){window.open(s.a.url.workSiteInstall.exportExcel+"?serialNo="+this.$parent.getCustomerId())},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleSizeChange:function(e){this.pageSize=e,this.getStartData()},handleCurrentChange:function(e){this.currentPage=e,this.getStartData()},eCharGo:function(){var e=this;this.userId=this.$parent.getUserId(),this.proStr=this.$parent.getProjectId(),s.a.post(s.a.url.workSiteInstall.showEchart,{pmId:this.proStr}).then(function(t){e.array=t.puserNameList,e.arrayNum=t.puserNumList,e.showEchart()})},showEchart:function(){var e={color:["#3398DB"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:this.array,axisTick:{alignWithLabel:!0},axisLabel:{color:"#666666",fontFamily:"Microsoft YaHei"},axisLine:{show:!1}}],yAxis:[{type:"value",axisLabel:{color:"#93abba"},axisLine:{lineStyle:{color:"#93abba"}}}],series:[{type:"bar",label:{show:!0},data:this.arrayNum,markPoint:{data:[{type:"max",name:"最大值"},{type:"min",name:"最小值"}]},markLine:{data:[{type:"average",name:"平均值"}]},itemStyle:{color:"#4d9eff"}}]};setTimeout(function(t){n.a.init(document.getElementById("main")).setOption(e)},0)}},filters:{connetArray:function(e){var t=e.printer.concat(e.desktop,e.moreScreen,e.ticker,e.cardReader);return t.length<=0?"请选择":t.toString()}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"site-install"},[a("div",{staticClass:"w-table"},[a("div",{staticClass:"w-table-btn"},[a("span",{class:{active:e.isActive},on:{click:e.siteEnd}},[a("i",{staticClass:"iconfont icon-conf-complete"}),e._v("确认完成")]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.isActive,expression:"!isActive"}],on:{click:e.openAddWindows}},[a("i",{staticClass:"iconfont icon-new-add"}),e._v("新增")]),e._v(" "),a("span",{on:{click:e.downloadExcel}},[a("i",{staticClass:"iconfont icon-export"}),e._v("导出")]),e._v(" "),a("span",{on:{click:function(t){e.chart=!0}}},[a("i",{staticClass:"iconfont icon-job-weight"}),e._v("工作比重")])]),e._v(" "),a("div",{staticClass:"w-table-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.installTableData}},[a("el-table-column",{attrs:{prop:"deptName",label:"科室名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"所需软件"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{size:"mini",multiple:"","collapse-tags":"",placeholder:"请选择"},on:{change:function(a){e.doSoftSelect(t.row.pppId,t.row.id)}},model:{value:t.row.pppId,callback:function(a){e.$set(t.row,"pppId",a)},expression:"scope.row.pppId"}},e._l(e.selectData.needSoftware,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"所需硬件"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{size:"mini",multiple:"","collapse-tags":"",placeholder:"请选择"},on:{change:function(a){e.doHardWareSelect(t.row.hhhId,t.row.id)}},model:{value:t.row.hhhId,callback:function(a){e.$set(t.row,"hhhId",a)},expression:"scope.row.hhhId"}},e._l(e.selectData.needHardware,function(e){return a("el-option",{key:e.id,attrs:{label:e.hwName,value:e.id}})}))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"是否本期范围"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:function(a){e.doRangeSelect(t.row.noScopeCode,t.row.id)}},model:{value:t.row.noScopeCode,callback:function(a){e.$set(t.row,"noScopeCode",a)},expression:"scope.row.noScopeCode"}},e._l(e.ranges,function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))}))]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"分配给"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:function(a){e.doUserSelect(t.row.map.puserName,t.row.id)}},model:{value:t.row.map.puserName,callback:function(a){e.$set(t.row.map,"puserName",a)},expression:"scope.row.map.puserName"}},e._l(e.selectData.assignedTo,function(e){return a("el-option",{key:e.id,attrs:{label:e.cName,value:e.id}})}))]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"站点数"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:function(a){e.doSiteSelect(t.row.num,t.row.id)}},model:{value:t.row.num,callback:function(a){e.$set(t.row,"num",a)},expression:"scope.row.num"}},e._l(e.selectData.siteNumber,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:t.row.stateClass},[e._v(e._s(t.row.map.siteInfo))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"operate"},[a("i",{staticClass:"iconfont icon-edit",on:{click:function(a){e.addSiteInstallDetail(t.row.id)}}}),e._v(" "),a("i",{staticClass:"iconfont icon-delete",on:{click:function(a){e.removeSite(t.row.id)}}})])]}}])})],1),e._v(" "),a("div",{staticClass:"w-table-page"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:"实施人员工作比重",width:"50%",visible:e.chart},on:{open:e.eCharGo,"update:visible":function(t){e.chart=t}}},[a("div",{attrs:{id:"main"}})]),e._v(" "),a("transition",{attrs:{leaveActiveClass:"animated fadeOutRight",enterActiveClass:"animated bounceInRight"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.newPage,expression:"newPage"}],staticClass:"new-page"},[a("div",{staticClass:"new-page_header"},[a("span",{staticClass:"new-page_title"},[e._v(e._s(e.deptName))]),e._v(" "),a("button",{staticClass:"el-dialog__headerbtn",attrs:{type:"button"},on:{click:function(t){e.newPage=!1}}},[a("i",{staticClass:"el-icon el-icon-close"})])]),e._v(" "),a("div",{staticClass:"new-page_body"},[a("div",{staticClass:"line"}),e._v(" "),a("div",[a("span",{staticClass:"icon-button",on:{click:function(t){e.addSiteDetail()}}},[a("i",{staticClass:"iconfont icon-new-add"}),e._v("新增站点")])]),e._v(" "),a("el-form",{attrs:{"label-width":"80px",size:"medium"}},e._l(e.siteDetailData,function(t){return a("div",[a("div",{staticClass:"add-site"},[a("div",{staticClass:"add-site_title"},[a("span",[e._v("站点")]),a("i",{staticClass:"el-icon-delete",on:{click:function(a){e.deteleSite(t.id)}}})]),e._v(" "),a("div",{staticClass:"add-site_body"},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"站点名称"}},[a("el-input",{model:{value:t.siteName,callback:function(a){e.$set(t,"siteName",a)},expression:"item.siteName"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"IP地址"}},[a("el-input",{model:{value:t.ip,callback:function(a){e.$set(t,"ip",a)},expression:"item.ip"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"楼宇"}},[a("el-input",{model:{value:t.building,callback:function(a){e.$set(t,"building",a)},expression:"item.building"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"楼层"}},[a("el-input",{attrs:{type:"number"},model:{value:t.floorNum,callback:function(a){e.$set(t,"floorNum",a)},expression:"item.floorNum"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"PC机型号"}},[a("el-input",{model:{value:t.pcModel,callback:function(a){e.$set(t,"pcModel",a)},expression:"item.pcModel"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"安装情况"}},[a("el-radio-group",{model:{value:t.install,callback:function(a){e.$set(t,"install",a)},expression:"item.install"}},[a("el-radio",{attrs:{label:1}},[e._v("已安装")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("未安装")])],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{md:24,lg:24}},[a("el-form-item",{attrs:{label:"上传照片"}},[a("el-upload",{attrs:{action:e.UploadUrl(t.id),"list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemoves,fileList:e.imgPathsUrl(t.imgPath,t.id)}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)],1)],1)],1)])])})),e._v(" "),a("div",{staticClass:"add-site_btn"},[a("el-button",{attrs:{size:"medium"},on:{click:function(t){e.newPage=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){e.saveSiteDetail("siteDetailData")}}},[e._v("保存")])],1)],1)])]),e._v(" "),a("el-dialog",{attrs:{title:"新增",width:"50%",visible:e.newAdd},on:{open:e.showEchart,"update:visible":function(t){e.newAdd=t}}},[a("el-form",{attrs:{model:e.formData,"label-width":"80px",size:"medium"}},[a("el-row",[a("el-col",{attrs:{md:7,lg:7}},[a("el-form-item",{attrs:{label:"科室分类"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:function(t){e.deptType(e.formData.deptType)}},model:{value:e.formData.deptType,callback:function(t){e.$set(e.formData,"deptType",t)},expression:"formData.deptType"}},e._l(e.selectDeptType,function(e){return a("el-option",{key:e.deptType,attrs:{label:e.typeName,value:e.deptType}})}))],1)],1),e._v(" "),a("el-col",{attrs:{md:7,lg:7}},[a("el-form-item",{attrs:{label:"科室名称"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.formData.departName,callback:function(t){e.$set(e.formData,"departName",t)},expression:"formData.departName"}},e._l(e.selectDept,function(e){return a("el-option",{key:e.deptCode,attrs:{label:e.deptName,value:e.deptCode}})}))],1)],1),e._v(" "),a("el-col",{attrs:{md:10,lg:10}},[a("el-form-item",{attrs:{label:"使用系统"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formData.userSystem,callback:function(t){e.$set(e.formData,"userSystem",t)},expression:"formData.userSystem"}},e._l(e.selectFormData,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.newAdd=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.saveDeptData}},[e._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var d=a("Z0/y")(r,c,!1,function(e){a("XWqO"),a("+1CO")},"data-v-495bf1c2",null);t.default=d.exports}});
//# sourceMappingURL=8.f8b6754b7cc8281e65ec.js.map