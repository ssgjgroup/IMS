webpackJsonp([17],{"/vOk":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("WhC7"),l={data:function(){return{pmId:"",dataType:"",activeName:"second",isActive:!1,formLabelWidth:"120px",pageSize:10,total:100,currentPage:1,process:{},look:!1,uploadWindow:!1,workderInforWindow:!1,action:o.a.url.basicData.uploadFile,fileList:[],workerInfo:[],workId:0,lookTile:"",gridData:[],workForm:{tableCode:"",tableName:"",tableCnName:"",dataType:"",tableAttention:""},rules:{tableCode:[{max:32,message:"长度最多为32",trigger:"blur"}],tableName:[{required:!0,message:"请输入库表名称",trigger:"blur"}],tableCnName:[{required:!0,message:"请输入中文名称",trigger:"blur"}],dataType:[{required:!0,message:"请输入数据类型",trigger:"blur"},{pattern:/^[0-9]*$/,message:"请输入数字",trigger:"blur"}],tableAttention:[]}}},created:function(){this.$parent.setSelectDisable(!0),this.$parent.setProjectInfo(),this.$nextTick(function(){this.getWorkerInfo()})},methods:{tabSwitch:function(t,e){console.log(t,e),this.activeName=t.name,this.getWorkerInfo()},deleteRow:function(){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message({type:"success",message:"删除成功!"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},getWorkerInfo:function(){var t=this,e=this.pageSize,a=(this.currentPage-1)*e;this.pmId=this.$parent.getProjectId(),console.log("projectId:"+this.pmId),"first"==this.activeName?this.dataType="0":"second"==this.activeName?this.dataType="1":"third"==this.activeName&&(this.dataType="2"),o.a.post(o.a.url.basicData.initData,{first:a,count:e,pmId:this.pmId,dataType:this.dataType}).then(function(e){console.log(e),t.workerInfo=e.rows,t.total=e.total,t.process=e.process,null==t.process.isBasicDataUse||1!=t.process.isBasicDataUse?t.isActive=!1:1==t.process.isBasicDataUse&&(t.isActive=!0)})},handleSizeChange:function(t){console.log("每页 "+t+" 条"),this.pageSize=t,this.getWorkerInfo()},handleCurrentChange:function(t){console.log("当前页: "+t),this.currentPage=t,this.getWorkerInfo()},getDetail:function(t){var e=this;this.look=!0,this.workId=t.id,this.lookTile=t.tableName,o.a.post(o.a.url.basicData.detail,{id:t.id}).then(function(t){console.log(t),e.gridData=t.data})},downloadExcel:function(){window.open(o.a.url.basicData.exportExcel+"?pmId="+this.pmId+"&dataType="+this.dataType)},handlePreview:function(t){console.log(t)},handleRemove:function(t,e){console.log(t,e)},uploadSeccess:function(t){console.log(t),"success"==t.status?(this.fileList=[],this.uploadWindow=!1,this.getWorkerInfo()):this.$message.warning(t.msg)},beforeRemove:function(t,e){return this.$confirm("确定移除 "+t.name+"？")},handleExceed:function(t,e){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+t.length+" 个文件，共选择了 "+(t.length+e.length)+" 个文件")},exportDataInfo:function(){console.log(this.workId),window.open(o.a.url.basicData.exportDataInfo+"?id="+this.workId)},exportSql:function(t){window.open(o.a.url.basicData.exportSql+"?id="+t)},openWorkinfoWindow:function(){this.workId=0,this.tableCode="",this.tableName="",this.tableCnName="",this.dataType="",this.tableAttention="",this.workderInforWindow=!0},addOrModify:function(t){var e=this;console.log(t);var a={id:this.workId,tableCode:this.workForm.tableCode,tableName:this.workForm.tableName,tableCnName:this.workForm.tableCnName,dataType:this.workForm.dataType,tableAttention:this.workForm.tableAttention};this.$refs[t].validate(function(t){t&&o.a.post(o.a.url.basicData.addOrModify,a).then(function(t){(t.status="success")&&e.getWorkerInfo(),e.workderInforWindow=!1})})},doConfirm:function(){var t=this,e="",a="";this.$confirm("确认完成, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.a.post(o.a.url.basicData.confirm,{pmId:t.pmId,dataType:t.dataType}).then(function(o){console.log(o),e=o.type,a=o.msg,t.$message({type:e,message:a}),"success"==e&&(t.isActive=!0)})}).catch(function(){t.$message({type:"info",message:"取消确认！"})})}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"base-data-maintain"},[a("div",{staticClass:"tab"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.tabSwitch},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"国标数据维护",name:"first"}},[a("div",{staticClass:"w-table"},[a("div",{staticClass:"w-table-btn"},[a("span",{class:{active:t.isActive},on:{click:t.doConfirm}},[a("i",{staticClass:"iconfont icon-conf-complete"}),t._v("确认完成")]),t._v(" "),a("span",{on:{click:t.downloadExcel}},[a("i",{staticClass:"iconfont icon-export"}),t._v("导出")])]),t._v(" "),a("div",{staticClass:"w-table-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.workerInfo}},[a("el-table-column",{attrs:{prop:"tableName",label:"THIS表名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tableCnName",label:"数据涵义"}}),t._v(" "),a("el-table-column",{attrs:{prop:"standardCode",label:"标准文号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tableAttention",label:"注意事项"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"operate"},[a("i",{staticClass:"iconfont icon-look-over",on:{click:function(a){t.getDetail(e.row)}}}),t._v(" "),a("i",{staticClass:"iconfont icon-export",on:{click:function(a){t.exportSql(e.row.id)}}})])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"w-table-page"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,20,30,40],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])]),t._v(" "),a("el-tab-pane",{attrs:{label:"行标数据维护",name:"second"}},[a("div",{staticClass:"w-table"},[a("div",{staticClass:"w-table-btn"},[a("span",{class:{active:t.isActive},on:{click:t.doConfirm}},[a("i",{staticClass:"iconfont icon-conf-complete"}),t._v("确认完成")]),t._v(" "),a("span",{on:{click:t.downloadExcel}},[a("i",{staticClass:"iconfont icon-export"}),t._v("导出")])]),t._v(" "),a("div",{staticClass:"w-table-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.workerInfo}},[a("el-table-column",{attrs:{prop:"tableName",label:"THIS表名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tableCnName",label:"数据涵义"}}),t._v(" "),a("el-table-column",{attrs:{prop:"standardCode",label:"标准文号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tableAttention",label:"注意事项"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"operate"},[a("i",{staticClass:"iconfont icon-look-over",on:{click:function(a){t.getDetail(e.row)}}}),t._v(" "),a("i",{staticClass:"iconfont icon-export",on:{click:function(a){t.exportSql(e.row.id)}}})])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"w-table-page"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,20,30,40],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])]),t._v(" "),a("el-tab-pane",{attrs:{label:"共享数据维护",name:"third"}},[a("div",{staticClass:"w-table"},[a("div",{staticClass:"w-table-btn"},[a("span",{class:{active:t.isActive},on:{click:t.doConfirm}},[a("i",{staticClass:"iconfont icon-conf-complete"}),t._v("确认完成")]),t._v(" "),a("span",{on:{click:t.downloadExcel}},[a("i",{staticClass:"iconfont icon-export"}),t._v("导出")])]),t._v(" "),a("div",{staticClass:"w-table-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.workerInfo}},[a("el-table-column",{attrs:{prop:"tableName",label:"THIS表名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tableCnName",label:"数据涵义"}}),t._v(" "),a("el-table-column",{attrs:{prop:"standardCode",label:"标准文号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tableAttention",label:"注意事项"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"operate"},[a("i",{staticClass:"iconfont icon-look-over",on:{click:function(a){t.getDetail(e.row)}}}),t._v(" "),a("i",{staticClass:"iconfont icon-export",on:{click:function(a){t.exportSql(e.row.id)}}})])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"w-table-page"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,20,30,40],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:t.lookTile,width:"30%",visible:t.look},on:{"update:visible":function(e){t.look=e}}},[a("el-table",{attrs:{data:t.gridData}},[a("el-table-column",{attrs:{property:"ID",label:"标准代码",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{property:"name",label:"标准名称",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{property:"memo",label:"备注"}})],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium"},on:{click:function(e){t.look=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){t.exportDataInfo()}}},[t._v("\n        导出\n      ")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"基础数据",width:"30%",visible:t.workderInforWindow},on:{"update:visible":function(e){t.workderInforWindow=e}}},[a("el-form",{ref:"workForm",attrs:{model:t.workForm,rules:t.rules}},[a("el-form-item",{attrs:{label:"库表编号","label-width":"80px",prop:"tableCode"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.workForm.tableCode,callback:function(e){t.$set(t.workForm,"tableCode",e)},expression:"workForm.tableCode"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"库表名称","label-width":"80px",prop:"tableName",required:""}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.workForm.tableName,callback:function(e){t.$set(t.workForm,"tableName",e)},expression:"workForm.tableName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"中文名称","label-width":"80px",prop:"tableCnName",required:""}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.workForm.tableCnName,callback:function(e){t.$set(t.workForm,"tableCnName",e)},expression:"workForm.tableCnName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"数据类型","label-width":"80px",prop:"dataType",required:""}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.workForm.dataType,callback:function(e){t.$set(t.workForm,"dataType",e)},expression:"workForm.dataType"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"注意事项","label-width":"80px",prop:"tableAttention"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.workForm.tableAttention,callback:function(e){t.$set(t.workForm,"tableAttention",e)},expression:"workForm.tableAttention"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.workderInforWindow=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addOrModify("workForm")}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"文件上传",width:"30%",visible:t.uploadWindow},on:{"update:visible":function(e){t.uploadWindow=e}}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:t.action,"on-preview":t.handlePreview,"on-remove":t.handleRemove,"on-success":t.uploadSeccess,"before-remove":t.beforeRemove,multiple:"",limit:1,"on-exceed":t.handleExceed,"file-list":t.fileList}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传xls/xlsx文件，且不超过500kb")])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.uploadWindow=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var n=a("Z0/y")(l,i,!1,function(t){a("13rU")},"data-v-54accdb2",null);e.default=n.exports},"13rU":function(t,e){}});
//# sourceMappingURL=17.587a1116a5c826662c50.js.map