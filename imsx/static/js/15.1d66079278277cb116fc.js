webpackJsonp([15],{A5DY:function(e,t){},Z0db:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("WhC7"),n={data:function(){return{pmId:"",activeName:"first",uploadWindow:!1,isActive:!1,process:{},ranges:[{label:"否",options:[{value:"不在合同范围",label:"不在合同范围"},{value:"本期不实施",label:"本期不实施"},{value:"医院暂时不用",label:"医院暂时不用"},{value:"其他",label:"其他"}]},{label:"是",options:[{value:"",label:"是"}]}],selectedOptions:[],upLoadData:{id:""},action:a.a.url.easyDataCheck.uploadFile,pageSize:10,total:100,currentPage:1,look:!1,fileList:[],checkTableData:[],gridData:[],multipleSelection:[]}},created:function(){this.$parent.setSelectDisable(!0),this.$parent.setProjectInfo(),this.initSourceData(),this.$nextTick(function(){this.getWorkerInfo()})},methods:{initSourceData:function(){a.a.post(a.a.url.easyDataCheck.initSourceData,{pmId:this.$parent.getProjectId(),operator:this.$parent.getUserId(),dataType:3}).then(function(e){console.log(e.msg)})},getWorkerInfo:function(){var e=this,t=this.pageSize,o=(this.currentPage-1)*t;this.pmId=this.$parent.getProjectId();var n=this.$parent.getUserId();console.log("projectId:"+this.pmId),a.a.post(a.a.url.easyDataCheck.initData,{first:o,count:t,pmId:this.pmId,operator:n}).then(function(t){console.log(t),e.checkTableData=t.rows,e.total=t.total,e.process=t.process,null==e.process.isEasyDataCheck||1!=e.process.isEasyDataCheck?e.isActive=!1:1==e.process.isEasyDataCheck&&(e.isActive=!0)})},handleSizeChange:function(e){console.log("每页 "+e+" 条"),this.pageSize=e,this.getWorkerInfo()},handleCurrentChange:function(e){console.log("当前页: "+e),this.currentPage=e,this.getWorkerInfo()},getDetail:function(e){var t=this;this.look=!0,this.workId=e,a.a.post(a.a.url.easyDataCheck.detail,{sourceId:e}).then(function(e){t.gridData=e.data})},doUpload:function(e){this.upLoadData.id=e,this.uploadWindow=!0},beforeUpload:function(e){var t=new FileReader;t.readAsDataURL(e),t.onload=function(){}},handlePreview:function(e){console.log(e)},handleRemove:function(e,t){console.log(e,t)},uploadSeccess:function(e){console.log(e),"success"==e.status?(this.fileList=[],this.uploadWindow=!1,this.getWorkerInfo()):this.$message.warning(e.msg)},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},exportSql:function(e){window.open(a.a.url.easyDataCheck.exportSql+"?id="+e)},handleChange:function(e){console.log(e),alert(this.selectedOptions)},handleSelectionChange:function(e){this.multipleSelection=e,console.info(this.multipleSelection)},downloadExcel:function(){window.open(a.a.url.easyDataCheck.exportModel)},batchExport:function(){var e=this.multipleSelection;if(0!=e.length){for(var t="",o=0;o<e.length;o++)t=""==t?e[o].id:t+","+e[o].id;window.open(a.a.url.easyDataCheck.batchExport+"?idsStr="+t)}},doRangeSelect:function(e,t){console.info("noScopeCode:"+e),console.info("id:"+t),a.a.post(a.a.url.easyDataCheck.changeScope,{noScopeCode:e,id:t,operator:this.$parent.getUserId()}).then(function(e){console.log(e.msg)})},doConfirm:function(){var e=this,t=this.$parent.getProjectId(),o="",n="",i="",l=0;this.isActive?(o="此操作将取消确认基础数据校验, 是否继续?",n="取消成功",i="已撤销取消",l=0):(o="此操作将确认基础数据校验, 是否继续?",n="确认成功",i="已取消确认",l=1),this.$confirm(o,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.a.post(a.a.url.easyDataCheck.confirm,{pmId:t,operator:e.$parent.getUserId(),isEasyDataCheck:l}).then(function(t){"success"==t.status&&(e.$message({type:"success",message:n}),e.isActive?e.isActive=!1:e.isActive=!0)})}).catch(function(){e.$message({type:"info",message:i})})}}},i={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"easy-data-check"},[o("div",{staticClass:"w-table"},[o("div",{staticClass:"w-table-btn"},[o("span",{class:{active:e.isActive},on:{click:e.doConfirm}},[o("i",{staticClass:"iconfont icon-conf-complete"}),e._v("确认完成")]),e._v(" "),o("span",{on:{click:e.batchExport}},[o("i",{staticClass:"iconfont icon-export"}),e._v("导出")]),e._v(" "),o("span",{on:{click:e.downloadExcel}},[o("i",{staticClass:"iconfont  el-icon-download"}),e._v("导出模板")])]),e._v(" "),o("div",{staticClass:"w-table-content"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.checkTableData},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection"}}),e._v(" "),o("el-table-column",{attrs:{prop:"map.type",label:"分类",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"isUse",label:"是否维护"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:function(o){e.doRangeSelect(t.row.noScopeCode,t.row.id)}},model:{value:t.row.noScopeCode,callback:function(o){e.$set(t.row,"noScopeCode",o)},expression:"scope.row.noScopeCode"}},e._l(e.ranges,function(t){return o("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))}))]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"content",label:"完成情况"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{class:t.row.map.state?"dangerous":"noraml"},[e._v(e._s(t.row.content))])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("div",{staticClass:"operate"},[o("i",{staticClass:"iconfont icon-export",on:{click:function(o){e.exportSql(t.row.id)}}}),e._v(" "),o("i",{staticClass:"iconfont icon-conf-complete",on:{click:function(o){e.doUpload(t.row.id)}}}),e._v(" "),o("i",{staticClass:"iconfont icon-look-over",on:{click:function(o){e.getDetail(t.row.id)}}})])]}}])})],1)],1),e._v(" "),o("div",{staticClass:"w-table-page"},[o("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),e._v(" "),o("el-dialog",{attrs:{title:"未达标的科室或医生如下表",width:"60%",visible:e.look},on:{"update:visible":function(t){e.look=t}}},[o("el-table",{attrs:{data:e.gridData,height:"300"}},[o("el-table-column",{attrs:{property:"deptDoctorCode","show-overflow-tooltip":"true",label:"科室或医生代码"}}),e._v(" "),o("el-table-column",{attrs:{property:"deptDoctorName","show-overflow-tooltip":"true",label:"科室或医生名称"}}),e._v(" "),o("el-table-column",{attrs:{property:"num","show-overflow-tooltip":"true",label:"数量"}})],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"文件上传",width:"30%",visible:e.uploadWindow},on:{"update:visible":function(t){e.uploadWindow=t}}},[o("el-upload",{staticClass:"upload-demo",attrs:{action:e.action,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-success":e.uploadSeccess,"before-remove":e.beforeRemove,"before-upload":e.beforeUpload,data:e.upLoadData,multiple:"",limit:1,"on-exceed":e.handleExceed,"file-list":e.fileList}},[o("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传xls/xlsx文件，且不超过500kb")])],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.uploadWindow=!1}}},[e._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var l=o("Z0/y")(n,i,!1,function(e){o("A5DY")},"data-v-6dad9ade",null);t.default=l.exports}});
//# sourceMappingURL=15.1d66079278277cb116fc.js.map